<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snowflake Migration Plan • ideadata</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Snowflake Migration Plan">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ideadata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/maintenance-guide.html">Package Maintenance and Development Guide</a>
    </li>
    <li>
      <a href="../articles/setting-up-your-credentials.html">Setting up your credentials</a>
    </li>
    <li>
      <a href="../articles/snowflake-migration.html">Snowflake Migration Plan</a>
    </li>
    <li>
      <a href="../articles/usage-guide.html">Comprehensive Usage Guide</a>
    </li>
    <li>
      <a href="../articles/using-collector.html">Using collector() for large data sets</a>
    </li>
    <li>
      <a href="../articles/using-get_table.html">Using get_table()</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Snowflake Migration Plan</h1>
            
      

      <div class="hidden name"><code>snowflake-migration.Rmd</code></div>

    </div>

    
    
<blockquote>
<p><strong>Purpose</strong>: Roadmap for migrating ideadata from SQL
Server to Snowflake <strong>Status</strong>: Planning Phase
<strong>Target</strong>: Support both SQL Server and Snowflake during
transition period</p>
</blockquote>
<hr>
<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ol style="list-style-type: decimal">
<li><a href="#executive-summary">Executive Summary</a></li>
<li><a href="#technical-comparison">Technical Comparison</a></li>
<li><a href="#migration-strategy">Migration Strategy</a></li>
<li><a href="#phased-implementation-plan">Phased Implementation
Plan</a></li>
<li><a href="#technical-implementation">Technical
Implementation</a></li>
<li><a href="#testing-strategy">Testing Strategy</a></li>
<li><a href="#user-communication-plan">User Communication Plan</a></li>
<li><a href="#rollback-plan">Rollback Plan</a></li>
<li><a href="#timeline-and-milestones">Timeline and Milestones</a></li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="executive-summary">Executive Summary<a class="anchor" aria-label="anchor" href="#executive-summary"></a>
</h2>
<div class="section level3">
<h3 id="current-state">Current State<a class="anchor" aria-label="anchor" href="#current-state"></a>
</h3>
<ul>
<li>
<strong>ideadata v4.0.0</strong> connects exclusively to IDEA’s SQL
Server data warehouse</li>
<li>Uses <strong>Kerberos authentication</strong> with ODBC
connections</li>
<li>Supports <strong>Windows, macOS, and Linux</strong>
</li>
<li>Serves data analysts across IDEA network</li>
</ul>
</div>
<div class="section level3">
<h3 id="target-state">Target State<a class="anchor" aria-label="anchor" href="#target-state"></a>
</h3>
<ul>
<li>Support <strong>both SQL Server and Snowflake</strong> connections
during transition</li>
<li>Seamless user experience with automatic backend detection</li>
<li>
<strong>Zero breaking changes</strong> for existing user code</li>
<li>Gradual migration as warehouse tables move to Snowflake</li>
</ul>
</div>
<div class="section level3">
<h3 id="key-challenges">Key Challenges<a class="anchor" aria-label="anchor" href="#key-challenges"></a>
</h3>
<table class="table">
<colgroup>
<col width="35%">
<col width="25%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th>Challenge</th>
<th>Impact</th>
<th>Mitigation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Different authentication (Kerberos → Snowflake)</td>
<td>High</td>
<td>Dual credential system</td>
</tr>
<tr class="even">
<td>Different SQL dialects</td>
<td>Medium</td>
<td>dbplyr handles most differences</td>
</tr>
<tr class="odd">
<td>Different connection patterns</td>
<td>Medium</td>
<td>Abstraction layer</td>
</tr>
<tr class="even">
<td>Two systems during migration</td>
<td>High</td>
<td>Metadata-driven routing</td>
</tr>
<tr class="odd">
<td>User retraining</td>
<td>Low</td>
<td>Maintain same R interface</td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="technical-comparison">Technical Comparison<a class="anchor" aria-label="anchor" href="#technical-comparison"></a>
</h2>
<div class="section level3">
<h3 id="sql-server-vs-snowflake">SQL Server vs Snowflake<a class="anchor" aria-label="anchor" href="#sql-server-vs-snowflake"></a>
</h3>
<table class="table">
<colgroup>
<col width="21%">
<col width="28%">
<col width="28%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th>Aspect</th>
<th>SQL Server</th>
<th>Snowflake</th>
<th>Impact</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Authentication</strong></td>
<td>Kerberos TGT</td>
<td>Username/Password, SSO, Key Pair</td>
<td>
<strong>HIGH</strong> - New auth flow needed</td>
</tr>
<tr class="even">
<td><strong>ODBC Driver</strong></td>
<td>“ODBC Driver 17 for SQL Server”</td>
<td>“SnowflakeDSIIDriver”</td>
<td>
<strong>MEDIUM</strong> - New driver setup</td>
</tr>
<tr class="odd">
<td><strong>Connection String</strong></td>
<td><code>Server=X.IPS.ORG;Database=Y</code></td>
<td><code>Server=account.snowflakecomputing.com</code></td>
<td>
<strong>MEDIUM</strong> - New format</td>
</tr>
<tr class="even">
<td><strong>Database Hierarchy</strong></td>
<td>Server → Database → Schema → Table</td>
<td>Account → Database → Schema → Table</td>
<td>
<strong>LOW</strong> - Similar structure</td>
</tr>
<tr class="odd">
<td><strong>SQL Dialect</strong></td>
<td>T-SQL</td>
<td>ANSI SQL (mostly compatible)</td>
<td>
<strong>LOW</strong> - dbplyr handles translation</td>
</tr>
<tr class="even">
<td><strong>Case Sensitivity</strong></td>
<td>Case-insensitive</td>
<td>Case-sensitive for identifiers</td>
<td>
<strong>MEDIUM</strong> - May affect queries</td>
</tr>
<tr class="odd">
<td><strong>Data Types</strong></td>
<td>SQL Server types</td>
<td>Snowflake types</td>
<td>
<strong>LOW</strong> - Mostly compatible</td>
</tr>
<tr class="even">
<td><strong>Lazy Evaluation</strong></td>
<td>Supported via dbplyr</td>
<td>Supported via dbplyr</td>
<td>
<strong>NONE</strong> - Same pattern</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="r-package-dependencies">R Package Dependencies<a class="anchor" aria-label="anchor" href="#r-package-dependencies"></a>
</h3>
<div class="section level4">
<h4 id="current-dependencies">Current Dependencies<a class="anchor" aria-label="anchor" href="#current-dependencies"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DBI</span>          <span class="co"># Database interface (supports both)</span></span>
<span><span class="va">odbc</span>         <span class="co"># ODBC connections (supports both)</span></span>
<span><span class="va">dbplyr</span>       <span class="co"># SQL translation (supports both)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="additional-dependencies-needed">Additional Dependencies Needed<a class="anchor" aria-label="anchor" href="#additional-dependencies-needed"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># No new packages required!</span></span>
<span><span class="co"># odbc package supports Snowflake via Snowflake ODBC driver</span></span></code></pre></div>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="migration-strategy">Migration Strategy<a class="anchor" aria-label="anchor" href="#migration-strategy"></a>
</h2>
<div class="section level3">
<h3 id="approach-dual-backend-support-with-metadata-routing">Approach: <strong>Dual-Backend Support with Metadata
Routing</strong><a class="anchor" aria-label="anchor" href="#approach-dual-backend-support-with-metadata-routing"></a>
</h3>
<div class="section level4">
<h4 id="core-principle">Core Principle<a class="anchor" aria-label="anchor" href="#core-principle"></a>
</h4>
<p><strong>Users don’t need to know which backend hosts their
data.</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># User code remains unchanged</span></span>
<span><span class="va">students</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_students.html">get_students</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">grade_level</span> <span class="op">&gt;=</span> <span class="fl">9</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Package automatically:</span></span>
<span><span class="co"># 1. Checks metadata for table location</span></span>
<span><span class="co"># 2. Connects to correct backend (SQL Server or Snowflake)</span></span>
<span><span class="co"># 3. Returns data transparently</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="architecture">Architecture<a class="anchor" aria-label="anchor" href="#architecture"></a>
</h3>
<pre><code>User's R Code
     ↓
get_students()
     ↓
get_table("Students")
     ↓
Check warehouse_metadata
     ↓
   ┌─────────────┐
   │ Is table in │
   │ Snowflake?  │
   └─────────────┘
     ↓         ↓
   YES        NO
     ↓         ↓
Snowflake   SQL Server
Connection  Connection
     ↓         ↓
   Return data</code></pre>
</div>
<div class="section level3">
<h3 id="key-design-decisions">Key Design Decisions<a class="anchor" aria-label="anchor" href="#key-design-decisions"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Maintain Single API</strong>: Users call same functions
regardless of backend</li>
<li>
<strong>Metadata-Driven</strong>: Metadata indicates which backend
hosts each table</li>
<li>
<strong>Connection Pooling</strong>: Maintain separate connection
pools for each backend</li>
<li>
<strong>Gradual Migration</strong>: Support both backends until SQL
Server fully deprecated</li>
<li>
<strong>Backwards Compatibility</strong>: Existing scripts continue
to work unchanged</li>
</ol>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="phased-implementation-plan">Phased Implementation Plan<a class="anchor" aria-label="anchor" href="#phased-implementation-plan"></a>
</h2>
<div class="section level3">
<h3 id="phase-0-preparation-4-6-weeks">Phase 0: Preparation (4-6 weeks)<a class="anchor" aria-label="anchor" href="#phase-0-preparation-4-6-weeks"></a>
</h3>
<p><strong>Goal</strong>: Understand Snowflake environment and prepare
infrastructure</p>
<div class="section level4">
<h4 id="tasks">Tasks<a class="anchor" aria-label="anchor" href="#tasks"></a>
</h4>
<ul class="task-list">
<li>
<label><input type="checkbox">Get Snowflake account details from
IT</label>
<ul>
<li>Account name</li>
<li>Warehouse name</li>
<li>Database naming conventions</li>
<li>Schema structure</li>
</ul>
</li>
<li>
<label><input type="checkbox">Obtain Snowflake credentials for
testing</label>
<ul>
<li>Username/password</li>
<li>Role and permissions needed</li>
</ul>
</li>
<li>
<label><input type="checkbox">Install Snowflake ODBC driver on
development machines</label>
<ul>
<li>Windows</li>
<li>macOS</li>
<li>Linux</li>
</ul>
</li>
<li><label><input type="checkbox">Test basic Snowflake connectivity
from R</label></li>
<li><label><input type="checkbox">Understand Snowflake metadata
structure</label></li>
<li><label><input type="checkbox">Create test Snowflake database with
sample tables</label></li>
</ul>
<p><strong>Deliverables</strong>: - Snowflake connection documentation -
Test environment setup guide - ODBC driver installation instructions</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="phase-1-core-infrastructure-6-8-weeks">Phase 1: Core Infrastructure (6-8 weeks)<a class="anchor" aria-label="anchor" href="#phase-1-core-infrastructure-6-8-weeks"></a>
</h3>
<p><strong>Goal</strong>: Add Snowflake support to package core without
breaking SQL Server</p>
<div class="section level4">
<h4 id="enhanced-credential-management">1.1 Enhanced Credential Management<a class="anchor" aria-label="anchor" href="#enhanced-credential-management"></a>
</h4>
<p><strong>File</strong>: <code>R/utils.R</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Setup Snowflake Credentials</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">setup_snowflake_creds</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_h1.html" class="external-link">cli_h1</a></span><span class="op">(</span><span class="st">"Snowflake Credential Setup"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">account</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readline.html" class="external-link">readline</a></span><span class="op">(</span><span class="st">"Snowflake account (e.g., 'xy12345.us-east-1'): "</span><span class="op">)</span></span>
<span>  <span class="va">warehouse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readline.html" class="external-link">readline</a></span><span class="op">(</span><span class="st">"Snowflake warehouse (e.g., 'COMPUTE_WH'): "</span><span class="op">)</span></span>
<span>  <span class="va">username</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readline.html" class="external-link">readline</a></span><span class="op">(</span><span class="st">"Snowflake username: "</span><span class="op">)</span></span>
<span>  <span class="va">password</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readline.html" class="external-link">readline</a></span><span class="op">(</span><span class="st">"Snowflake password: "</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Option: use keyring for secure storage</span></span>
<span>  <span class="fu">keyring</span><span class="fu">::</span><span class="fu">key_set_with_value</span><span class="op">(</span></span>
<span>    service <span class="op">=</span> <span class="st">"snowflake_ideadata"</span>,</span>
<span>    username <span class="op">=</span> <span class="va">username</span>,</span>
<span>    password <span class="op">=</span> <span class="va">password</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Also store in .Renviron for backwards compatibility</span></span>
<span>  <span class="fu">usethis</span><span class="fu">::</span><span class="fu">edit_r_environ</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_info</a></span><span class="op">(</span><span class="st">"Add these lines to .Renviron:"</span><span class="op">)</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_code.html" class="external-link">cli_code</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">    SNOWFLAKE_ACCOUNT={account}</span></span>
<span><span class="st">    SNOWFLAKE_WAREHOUSE={warehouse}</span></span>
<span><span class="st">    SNOWFLAKE_USER={username}</span></span>
<span><span class="st">    SNOWFLAKE_PASSWORD={password}</span></span>
<span><span class="st">  "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Get Snowflake Credentials</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @keywords internal</span></span>
<span><span class="va">get_snowflake_creds</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    account <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SNOWFLAKE_ACCOUNT"</span><span class="op">)</span>,</span>
<span>    warehouse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SNOWFLAKE_WAREHOUSE"</span><span class="op">)</span>,</span>
<span>    user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SNOWFLAKE_USER"</span><span class="op">)</span>,</span>
<span>    password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SNOWFLAKE_PASSWORD"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="dual-connection-management">1.2 Dual Connection Management<a class="anchor" aria-label="anchor" href="#dual-connection-management"></a>
</h4>
<p><strong>File</strong>: <code>R/connections.R</code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Create Snowflake Connection</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param .database_name Database name</span></span>
<span><span class="co">#' @param .schema_name Schema name (optional)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return DBI connection object</span></span>
<span><span class="co">#' @keywords internal</span></span>
<span><span class="va">create_snowflake_connection</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.database_name</span>, <span class="va">.schema_name</span> <span class="op">=</span> <span class="st">"PUBLIC"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">creds</span> <span class="op">&lt;-</span> <span class="fu">get_snowflake_creds</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">creds</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Snowflake credentials not configured. Run setup_snowflake_creds()"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">connection_string</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span></span>
<span>    <span class="st">"Driver={{SnowflakeDSIIDriver}};"</span>,</span>
<span>    <span class="st">"Server={creds$account}.snowflakecomputing.com;"</span>,</span>
<span>    <span class="st">"Database={.database_name};"</span>,</span>
<span>    <span class="st">"Schema={.schema_name};"</span>,</span>
<span>    <span class="st">"Warehouse={creds$warehouse};"</span>,</span>
<span>    <span class="st">"UID={creds$user};"</span>,</span>
<span>    <span class="st">"PWD={creds$password}"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span></span>
<span>    <span class="fu">odbc</span><span class="fu">::</span><span class="fu"><a href="https://odbc.r-dbi.org/reference/dbConnect-OdbcDriver-method.html" class="external-link">odbc</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .connection_string <span class="op">=</span> <span class="va">connection_string</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">con</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Create SQL Server Connection (refactored existing function)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @keywords internal</span></span>
<span><span class="va">create_sqlserver_connection</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.database_name</span>, <span class="va">.server_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Existing create_connection() logic</span></span>
<span>  <span class="co"># Renamed for clarity</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Check and Get Connection (enhanced)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param .database_name Database name</span></span>
<span><span class="co">#' @param .server_name Server name (for SQL Server)</span></span>
<span><span class="co">#' @param .backend Backend type: "sqlserver" or "snowflake"</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return DBI connection object</span></span>
<span><span class="co">#' @keywords internal</span></span>
<span><span class="va">check_get_connection</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.database_name</span>,</span>
<span>                                  <span class="va">.server_name</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                  <span class="va">.backend</span> <span class="op">=</span> <span class="st">"sqlserver"</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Generate connection name</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">.backend</span> <span class="op">==</span> <span class="st">"snowflake"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">con_name</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"conn_snowflake_{.database_name}"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">con_name</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"conn_{.database_name}"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Check if connection exists and is valid</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="va">con_name</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">con_name</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbIsValid.html" class="external-link">dbIsValid</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Create new connection</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">.backend</span> <span class="op">==</span> <span class="st">"snowflake"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">create_snowflake_connection</span><span class="op">(</span><span class="va">.database_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">create_sqlserver_connection</span><span class="op">(</span><span class="va">.database_name</span>, <span class="va">.server_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Store in global environment</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="va">con_name</span>, <span class="va">con</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">con</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="enhanced-metadata-system">1.3 Enhanced Metadata System<a class="anchor" aria-label="anchor" href="#enhanced-metadata-system"></a>
</h4>
<p><strong>File</strong>: <code>R/warehouse_meta_data.R</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Enhanced Warehouse Metadata</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Metadata now includes backend type (sqlserver or snowflake)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @format tibble with columns:</span></span>
<span><span class="co">#' \describe{</span></span>
<span><span class="co">#'   \item{table_name}{Table name}</span></span>
<span><span class="co">#'   \item{database_name}{Database name}</span></span>
<span><span class="co">#'   \item{schema_name}{Schema name}</span></span>
<span><span class="co">#'   \item{server_name}{Server name (for SQL Server)}</span></span>
<span><span class="co">#'   \item{backend}{Backend type: "sqlserver" or "snowflake"}</span></span>
<span><span class="co">#'   \item{account}{Snowflake account (for Snowflake tables)}</span></span>
<span><span class="co">#' }</span></span>
<span><span class="st">"warehouse_meta_data"</span></span>
<span></span>
<span><span class="co">#' Get Warehouse Metadata (enhanced)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Fetches metadata from both SQL Server and Snowflake</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @keywords internal</span></span>
<span><span class="va">get_warehouse_meta_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Get SQL Server metadata (existing logic)</span></span>
<span>  <span class="va">sqlserver_meta</span> <span class="op">&lt;-</span> <span class="fu">get_sqlserver_metadata</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Get Snowflake metadata (new)</span></span>
<span>  <span class="va">snowflake_meta</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>    <span class="fu">get_snowflake_metadata</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># If Snowflake not configured, return empty tibble</span></span>
<span>      <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        table_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        database_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        schema_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        backend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Combine</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">sqlserver_meta</span>, <span class="va">snowflake_meta</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Get Snowflake Metadata</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @keywords internal</span></span>
<span><span class="va">get_snowflake_metadata</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Connect to Snowflake INFORMATION_SCHEMA</span></span>
<span>  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">create_snowflake_connection</span><span class="op">(</span><span class="st">"INFORMATION_SCHEMA"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Query metadata</span></span>
<span>  <span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html" class="external-link">dbGetQuery</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"</span></span>
<span><span class="st">    SELECT</span></span>
<span><span class="st">      table_name,</span></span>
<span><span class="st">      table_schema AS schema_name,</span></span>
<span><span class="st">      table_catalog AS database_name,</span></span>
<span><span class="st">      'snowflake' AS backend</span></span>
<span><span class="st">    FROM information_schema.tables</span></span>
<span><span class="st">    WHERE table_type = 'BASE TABLE'</span></span>
<span><span class="st">  "</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="enhanced-get_table">1.4 Enhanced <code>get_table()</code><a class="anchor" aria-label="anchor" href="#enhanced-get_table"></a>
</h4>
<p><strong>File</strong>: <code>R/get_table.R</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Get Table (enhanced for dual backend)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param .table_name Table name</span></span>
<span><span class="co">#' @param .database_name Database name (optional)</span></span>
<span><span class="co">#' @param .schema Schema name (optional)</span></span>
<span><span class="co">#' @param .server_name Server name (for SQL Server, optional)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return Lazy tbl_sql object</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">get_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.table_name</span>,</span>
<span>                      <span class="va">.database_name</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                      <span class="va">.schema</span> <span class="op">=</span> <span class="st">"dbo"</span>,</span>
<span>                      <span class="va">.server_name</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Look up table in metadata</span></span>
<span>  <span class="va">matches</span> <span class="op">&lt;-</span> <span class="va">warehouse_meta_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">table_name</span> <span class="op">==</span> <span class="va">.table_name</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Apply filters if provided</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">.database_name</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">matches</span> <span class="op">&lt;-</span> <span class="va">matches</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">database_name</span> <span class="op">==</span> <span class="va">.database_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">.server_name</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">matches</span> <span class="op">&lt;-</span> <span class="va">matches</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">server_name</span> <span class="op">==</span> <span class="va">.server_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Handle multiple/no matches (existing logic)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">matches</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"No table named '{.table_name}' found"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">matches</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Show options (existing logic)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Multiple tables found. Please specify .database_name and/or .server_name"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Single match - get connection</span></span>
<span>  <span class="va">match</span> <span class="op">&lt;-</span> <span class="va">matches</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">match</span><span class="op">$</span><span class="va">backend</span> <span class="op">==</span> <span class="st">"snowflake"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_get_connection.html">check_get_connection</a></span><span class="op">(</span></span>
<span>      .database_name <span class="op">=</span> <span class="va">match</span><span class="op">$</span><span class="va">database_name</span>,</span>
<span>      .backend <span class="op">=</span> <span class="st">"snowflake"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">schema</span> <span class="op">&lt;-</span> <span class="va">match</span><span class="op">$</span><span class="va">schema_name</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_get_connection.html">check_get_connection</a></span><span class="op">(</span></span>
<span>      .database_name <span class="op">=</span> <span class="va">match</span><span class="op">$</span><span class="va">database_name</span>,</span>
<span>      .server_name <span class="op">=</span> <span class="va">match</span><span class="op">$</span><span class="va">server_name</span>,</span>
<span>      .backend <span class="op">=</span> <span class="st">"sqlserver"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">schema</span> <span class="op">&lt;-</span> <span class="va">.schema</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Return lazy table</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="fu">dbplyr</span><span class="fu">::</span><span class="fu"><a href="https://dbplyr.tidyverse.org/reference/in_schema.html" class="external-link">in_schema</a></span><span class="op">(</span><span class="va">schema</span>, <span class="va">.table_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="testing-infrastructure">1.5 Testing Infrastructure<a class="anchor" aria-label="anchor" href="#testing-infrastructure"></a>
</h4>
<p><strong>File</strong>:
<code>tests/testthat/test-snowflake.R</code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"Snowflake credentials can be retrieved"</span>, <span class="op">{</span></span>
<span>  <span class="fu">skip_if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SNOWFLAKE_ACCOUNT"</span><span class="op">)</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">creds</span> <span class="op">&lt;-</span> <span class="fu">get_snowflake_creds</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_type</span><span class="op">(</span><span class="va">creds</span>, <span class="st">"list"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"account"</span>, <span class="st">"warehouse"</span>, <span class="st">"user"</span>, <span class="st">"password"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">creds</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"Can create Snowflake connection"</span>, <span class="op">{</span></span>
<span>  <span class="fu">skip_if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SNOWFLAKE_ACCOUNT"</span><span class="op">)</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">create_snowflake_connection</span><span class="op">(</span><span class="st">"TEST_DATABASE"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_s4_class</span><span class="op">(</span><span class="va">con</span>, <span class="st">"OdbcConnection"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbIsValid.html" class="external-link">dbIsValid</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"get_table() works with Snowflake backend"</span>, <span class="op">{</span></span>
<span>  <span class="fu">skip_if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SNOWFLAKE_ACCOUNT"</span><span class="op">)</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Assuming there's a test table in Snowflake</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_table.html">get_table</a></span><span class="op">(</span><span class="st">"TEST_TABLE"</span>, .database_name <span class="op">=</span> <span class="st">"TEST_DATABASE"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">result</span>, <span class="st">"tbl_sql"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="st">"tbl_lazy"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p><strong>Deliverables</strong>: - Enhanced connection management
supporting both backends - Metadata system that identifies backend for
each table - Updated <code><a href="../reference/get_table.html">get_table()</a></code> with automatic backend
routing - Snowflake credential setup functions - Test suite for
Snowflake functionality</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="phase-2-user-facing-enhancements-3-4-weeks">Phase 2: User-Facing Enhancements (3-4 weeks)<a class="anchor" aria-label="anchor" href="#phase-2-user-facing-enhancements-3-4-weeks"></a>
</h3>
<p><strong>Goal</strong>: Improve user experience and provide migration
utilities</p>
<div class="section level4">
<h4 id="status-and-discovery-functions">2.1 Status and Discovery Functions<a class="anchor" aria-label="anchor" href="#status-and-discovery-functions"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Check Which Backend Hosts a Table</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param .table_name Table name</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return Character: "sqlserver", "snowflake", or "both"</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' \dontrun{</span></span>
<span><span class="co">#' which_backend("Students")</span></span>
<span><span class="co">#' # [1] "sqlserver"</span></span>
<span><span class="co">#' }</span></span>
<span><span class="va">which_backend</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.table_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">matches</span> <span class="op">&lt;-</span> <span class="va">warehouse_meta_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">table_name</span> <span class="op">==</span> <span class="va">.table_name</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">matches</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_warning</a></span><span class="op">(</span><span class="st">"Table '{.table_name}' not found"</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">backends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">matches</span><span class="op">$</span><span class="va">backend</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">backends</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">backends</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"both"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Show Migration Status</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Shows which tables have been migrated to Snowflake</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param .database_name Optional database to filter</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return tibble with migration status</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">show_migration_status</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.database_name</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">summary</span> <span class="op">&lt;-</span> <span class="va">warehouse_meta_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="op">{</span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">.database_name</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">database_name</span> <span class="op">==</span> <span class="va">.database_name</span><span class="op">)</span> <span class="kw">else</span> <span class="va">.</span><span class="op">}</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">database_name</span>, <span class="va">backend</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">backend</span>, values_from <span class="op">=</span> <span class="va">n</span>, values_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      total <span class="op">=</span> <span class="va">sqlserver</span> <span class="op">+</span> <span class="va">snowflake</span>,</span>
<span>      pct_migrated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">snowflake</span> <span class="op">/</span> <span class="va">total</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="connection-diagnostics">2.2 Connection Diagnostics<a class="anchor" aria-label="anchor" href="#connection-diagnostics"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Diagnose Connection Issues</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Tests connections to both backends and reports status</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">diagnose_connections</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_h1.html" class="external-link">cli_h1</a></span><span class="op">(</span><span class="st">"Connection Diagnostics"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Test SQL Server</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_h1.html" class="external-link">cli_h2</a></span><span class="op">(</span><span class="st">"SQL Server"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">create_sqlserver_connection</span><span class="op">(</span><span class="st">"PowerSchool"</span>, <span class="st">"REDACTED-SQLSERVER"</span><span class="op">)</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_success</a></span><span class="op">(</span><span class="st">"SQL Server connection: OK"</span><span class="op">)</span></span>
<span>    <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span>  <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_danger</a></span><span class="op">(</span><span class="st">"SQL Server connection: FAILED"</span><span class="op">)</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_info</a></span><span class="op">(</span><span class="va">e</span><span class="op">$</span><span class="va">message</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Test Snowflake</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_h1.html" class="external-link">cli_h2</a></span><span class="op">(</span><span class="st">"Snowflake"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">creds</span> <span class="op">&lt;-</span> <span class="fu">get_snowflake_creds</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">creds</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_warning</a></span><span class="op">(</span><span class="st">"Snowflake credentials not configured"</span><span class="op">)</span></span>
<span>      <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_info</a></span><span class="op">(</span><span class="st">"Run setup_snowflake_creds() to configure"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">create_snowflake_connection</span><span class="op">(</span><span class="st">"INFORMATION_SCHEMA"</span><span class="op">)</span></span>
<span>      <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_success</a></span><span class="op">(</span><span class="st">"Snowflake connection: OK"</span><span class="op">)</span></span>
<span>      <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_danger</a></span><span class="op">(</span><span class="st">"Snowflake connection: FAILED"</span><span class="op">)</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert_info</a></span><span class="op">(</span><span class="va">e</span><span class="op">$</span><span class="va">message</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="updated-vignettes">2.3 Updated Vignettes<a class="anchor" aria-label="anchor" href="#updated-vignettes"></a>
</h4>
<p>Create new vignette: <strong>“Snowflake Migration Guide for
Users”</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu">use_vignette</span><span class="op">(</span><span class="st">"snowflake-migration"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Content</strong>: - What’s changing (backend, not interface)
- How to set up Snowflake credentials - How to check which backend hosts
data - Troubleshooting Snowflake connections - FAQ</p>
<p><strong>Deliverables</strong>: - User-facing status and discovery
functions - Diagnostic utilities - User documentation and vignettes</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="phase-3-gradual-data-migration-12-24-months">Phase 3: Gradual Data Migration (12-24 months)<a class="anchor" aria-label="anchor" href="#phase-3-gradual-data-migration-12-24-months"></a>
</h3>
<p><strong>Goal</strong>: Migrate tables from SQL Server to
Snowflake</p>
<div class="section level4">
<h4 id="this-is-not-a-package-development-task">This is NOT a package development task<a class="anchor" aria-label="anchor" href="#this-is-not-a-package-development-task"></a>
</h4>
<p>This phase is handled by the <strong>Data Warehouse Team</strong>.
The package automatically adapts as tables migrate.</p>
</div>
<div class="section level4">
<h4 id="package-requirements">Package Requirements<a class="anchor" aria-label="anchor" href="#package-requirements"></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Metadata stays current</strong>: Metadata must accurately
reflect table locations</li>
<li>
<strong>Monitor migration</strong>: Use
<code>show_migration_status()</code> to track progress</li>
<li>
<strong>Support users</strong>: Help troubleshoot issues as they
arise</li>
<li>
<strong>No code changes needed</strong>: Package automatically
routes to correct backend</li>
</ol>
</div>
<div class="section level4">
<h4 id="timeline-example">Timeline Example<a class="anchor" aria-label="anchor" href="#timeline-example"></a>
</h4>
<table class="table">
<colgroup>
<col width="21%">
<col width="40%">
<col width="21%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>Quarter</th>
<th>Tables Migrated</th>
<th>Backend</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Q1 2025</td>
<td>0%</td>
<td>100% SQL Server</td>
<td>Package v5.0.0 released with dual support</td>
</tr>
<tr class="even">
<td>Q2 2025</td>
<td>10%</td>
<td>90% SQL Server</td>
<td>Low-risk tables migrated first</td>
</tr>
<tr class="odd">
<td>Q3 2025</td>
<td>30%</td>
<td>70% SQL Server</td>
<td>Assessment data migrated</td>
</tr>
<tr class="even">
<td>Q4 2025</td>
<td>60%</td>
<td>40% SQL Server</td>
<td>PowerSchool data migrated</td>
</tr>
<tr class="odd">
<td>Q1 2026</td>
<td>90%</td>
<td>10% SQL Server</td>
<td>Most tables migrated</td>
</tr>
<tr class="even">
<td>Q2 2026</td>
<td>100%</td>
<td>0% SQL Server</td>
<td>Migration complete</td>
</tr>
</tbody>
</table>
<p><strong>Deliverables</strong>: - Communication plan for each
migration wave - Support documentation for common issues - Monitoring
dashboard for migration progress</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="phase-4-sql-server-deprecation-after-full-migration">Phase 4: SQL Server Deprecation (After full migration)<a class="anchor" aria-label="anchor" href="#phase-4-sql-server-deprecation-after-full-migration"></a>
</h3>
<p><strong>Goal</strong>: Remove SQL Server support after all tables
migrated</p>
<div class="section level4">
<h4 id="tasks-1">Tasks<a class="anchor" aria-label="anchor" href="#tasks-1"></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Announce deprecation timeline</strong>
<ul>
<li>Email to all users</li>
<li>Update documentation with deprecation notices</li>
<li>6-month warning period</li>
</ul>
</li>
<li>
<strong>Create package v6.0.0 (Snowflake-only)</strong>
<ul>
<li>Remove SQL Server connection code</li>
<li>Remove Kerberos authentication</li>
<li>Simplify metadata system</li>
<li>Update all documentation</li>
</ul>
</li>
<li>
<strong>Maintain v5.x for legacy support</strong>
<ul>
<li>Critical bug fixes only</li>
<li>For users still needing SQL Server access</li>
</ul>
</li>
</ol>
<p><strong>Deliverables</strong>: - ideadata v6.0.0 (Snowflake-only) -
Deprecation announcement - Migration guide for updating code (minimal
changes)</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="technical-implementation">Technical Implementation<a class="anchor" aria-label="anchor" href="#technical-implementation"></a>
</h2>
<div class="section level3">
<h3 id="code-structure-changes">Code Structure Changes<a class="anchor" aria-label="anchor" href="#code-structure-changes"></a>
</h3>
<pre><code>ideadata/
├── R/
│   ├── connections.R              # (MODIFIED) Dual backend support
│   ├── connections_sqlserver.R    # (NEW) SQL Server-specific
│   ├── connections_snowflake.R    # (NEW) Snowflake-specific
│   ├── get_table.R                # (MODIFIED) Backend routing
│   ├── warehouse_meta_data.R      # (MODIFIED) Enhanced metadata
│   ├── utils.R                    # (MODIFIED) Credential setup for both
│   ├── diagnostics.R              # (NEW) Connection diagnostics
│   └── migration_utils.R          # (NEW) Migration status functions
│
├── vignettes/
│   ├── snowflake-migration.Rmd    # (NEW) User migration guide
│   └── snowflake-setup.Rmd        # (NEW) Snowflake credential setup
│
└── tests/testthat/
    ├── test-snowflake.R           # (NEW) Snowflake tests
    └── test-dual-backend.R        # (NEW) Integration tests</code></pre>
</div>
<div class="section level3">
<h3 id="backward-compatibility">Backward Compatibility<a class="anchor" aria-label="anchor" href="#backward-compatibility"></a>
</h3>
<p><strong>Guarantee</strong>: All existing user code continues to work
unchanged.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This code from 2024 still works in 2026</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://idea-analytics.github.io/ideadata">ideadata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">students</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_students.html">get_students</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">grade_level</span> <span class="op">&gt;=</span> <span class="fl">9</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Package handles backend changes automatically</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a>
</h3>
<div class="section level4">
<h4 id="connection-pooling">Connection Pooling<a class="anchor" aria-label="anchor" href="#connection-pooling"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Maintain separate pools for each backend</span></span>
<span><span class="va">conn_PowerSchool</span>           <span class="co"># SQL Server</span></span>
<span><span class="va">conn_snowflake_POWERSCHOOL</span> <span class="co"># Snowflake</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="query-performance">Query Performance<a class="anchor" aria-label="anchor" href="#query-performance"></a>
</h4>
<ul>
<li>
<strong>Snowflake</strong>: May be faster for large
aggregations</li>
<li>
<strong>SQL Server</strong>: May be faster for small, indexed
queries</li>
<li>
<strong>Impact</strong>: Minimal for typical queries; monitor
performance</li>
</ul>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="testing-strategy">Testing Strategy<a class="anchor" aria-label="anchor" href="#testing-strategy"></a>
</h2>
<div class="section level3">
<h3 id="test-environments">Test Environments<a class="anchor" aria-label="anchor" href="#test-environments"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Development</strong>: Local machine with both backends</li>
<li>
<strong>Staging</strong>: Test Snowflake account</li>
<li>
<strong>Production</strong>: Production Snowflake account</li>
</ol>
</div>
<div class="section level3">
<h3 id="test-scenarios">Test Scenarios<a class="anchor" aria-label="anchor" href="#test-scenarios"></a>
</h3>
<div class="section level4">
<h4 id="unit-tests">Unit Tests<a class="anchor" aria-label="anchor" href="#unit-tests"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox" checked>SQL Server connection
creation</label></li>
<li><label><input type="checkbox">Snowflake connection
creation</label></li>
<li><label><input type="checkbox">Metadata retrieval from both
backends</label></li>
<li><label><input type="checkbox">Backend routing logic</label></li>
<li><label><input type="checkbox">Credential management</label></li>
</ul>
</div>
<div class="section level4">
<h4 id="integration-tests">Integration Tests<a class="anchor" aria-label="anchor" href="#integration-tests"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox">Get table from SQL
Server</label></li>
<li><label><input type="checkbox">Get table from
Snowflake</label></li>
<li><label><input type="checkbox">Join tables across backends (if
needed)</label></li>
<li><label><input type="checkbox">Collector() with
Snowflake</label></li>
<li><label><input type="checkbox">Connection pooling</label></li>
</ul>
</div>
<div class="section level4">
<h4 id="user-acceptance-tests">User Acceptance Tests<a class="anchor" aria-label="anchor" href="#user-acceptance-tests"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox">Analyst workflow with SQL Server
tables</label></li>
<li><label><input type="checkbox">Analyst workflow with Snowflake
tables</label></li>
<li><label><input type="checkbox">Analyst workflow with mixed
backends</label></li>
<li><label><input type="checkbox">Setup credentials for new
user</label></li>
<li><label><input type="checkbox">Troubleshoot connection
issues</label></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="continuous-testing">Continuous Testing<a class="anchor" aria-label="anchor" href="#continuous-testing"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In tests/testthat/setup.R</span></span>
<span><span class="co"># Set up test environment for both backends</span></span>
<span></span>
<span><span class="co"># Create test connections</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SNOWFLAKE_ACCOUNT"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">test_snowflake_con</span> <span class="op">&lt;-</span> <span class="fu">create_snowflake_connection</span><span class="op">(</span><span class="st">"TEST_DB"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="st">"test_snowflake_con"</span>, <span class="va">test_snowflake_con</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"IDEA_RNA_DB_UID"</span><span class="op">)</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">test_sqlserver_con</span> <span class="op">&lt;-</span> <span class="fu">create_sqlserver_connection</span><span class="op">(</span><span class="st">"PowerSchool"</span>, <span class="st">"REDACTED-SQLSERVER"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="st">"test_sqlserver_con"</span>, <span class="va">test_sqlserver_con</span>, envir <span class="op">=</span> <span class="va">.GlobalEnv</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="user-communication-plan">User Communication Plan<a class="anchor" aria-label="anchor" href="#user-communication-plan"></a>
</h2>
<div class="section level3">
<h3 id="announcement-timeline">Announcement Timeline<a class="anchor" aria-label="anchor" href="#announcement-timeline"></a>
</h3>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="33%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th>When</th>
<th>What</th>
<th>Audience</th>
<th>Medium</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Phase 0</td>
<td>“Snowflake migration coming in 2025”</td>
<td>All users</td>
<td>Email</td>
</tr>
<tr class="even">
<td>Phase 1 Start</td>
<td>“New package version supports Snowflake”</td>
<td>All users</td>
<td>Email + Training</td>
</tr>
<tr class="odd">
<td>Phase 2 Complete</td>
<td>“How to check migration status”</td>
<td>Power users</td>
<td>Workshop</td>
</tr>
<tr class="even">
<td>Phase 3 Start</td>
<td>“First tables migrating to Snowflake”</td>
<td>All users</td>
<td>Email</td>
</tr>
<tr class="odd">
<td>Each Migration</td>
<td>“These tables now on Snowflake”</td>
<td>All users</td>
<td>Email</td>
</tr>
<tr class="even">
<td>Phase 4 Start</td>
<td>“SQL Server deprecation timeline”</td>
<td>All users</td>
<td>Email + Meeting</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="training-materials">Training Materials<a class="anchor" aria-label="anchor" href="#training-materials"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Quick Start Guide</strong>: “Using ideadata with
Snowflake”</li>
<li>
<strong>Video Tutorial</strong>: “Setting up Snowflake
credentials”</li>
<li>
<strong>FAQ Document</strong>: Common questions and issues</li>
<li>
<strong>Office Hours</strong>: Weekly support sessions during
migration</li>
</ol>
</div>
<div class="section level3">
<h3 id="support-channels">Support Channels<a class="anchor" aria-label="anchor" href="#support-channels"></a>
</h3>
<ul>
<li>
<strong>Slack</strong>: #ideadata-support channel</li>
<li>
<strong>Email</strong>: <a href="mailto:analytics-team@ideapublicschools.org" class="email">analytics-team@ideapublicschools.org</a>
</li>
<li>
<strong>Documentation</strong>: <a href="https://idea-analytics.github.io/ideadata" class="uri">https://idea-analytics.github.io/ideadata</a>
</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="rollback-plan">Rollback Plan<a class="anchor" aria-label="anchor" href="#rollback-plan"></a>
</h2>
<div class="section level3">
<h3 id="scenario-critical-snowflake-issue">Scenario: Critical Snowflake Issue<a class="anchor" aria-label="anchor" href="#scenario-critical-snowflake-issue"></a>
</h3>
<p>If Snowflake becomes unavailable:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Immediate</strong>: Users’ code continues working with SQL
Server tables</li>
<li>
<strong>Short-term</strong>: Temporarily halt table migrations</li>
<li>
<strong>Medium-term</strong>: Investigate and resolve Snowflake
issue</li>
<li>
<strong>Long-term</strong>: Resume migration when stable</li>
</ol>
</div>
<div class="section level3">
<h3 id="scenario-package-bug-in-dual-backend">Scenario: Package Bug in Dual Backend<a class="anchor" aria-label="anchor" href="#scenario-package-bug-in-dual-backend"></a>
</h3>
<p>If dual backend code has critical bug:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Hotfix</strong>: Patch bug in v5.0.1</p></li>
<li>
<p><strong>Rollback</strong>: Users can install v4.0.0 (SQL Server
only)</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"idea-analytics/ideadata@v4.0.0"</span><span class="op">)</span></span></code></pre></div>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="scenario-table-migration-failure">Scenario: Table Migration Failure<a class="anchor" aria-label="anchor" href="#scenario-table-migration-failure"></a>
</h3>
<p>If migrated table has data issues:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Metadata update</strong>: Point table back to SQL Server in
metadata</li>
<li>
<strong>Package adapts</strong>: Next package load, users
automatically use SQL Server</li>
<li>
<strong>Data fix</strong>: Resolve Snowflake data issue</li>
<li>
<strong>Metadata update</strong>: Point table back to Snowflake</li>
</ol>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="timeline-and-milestones">Timeline and Milestones<a class="anchor" aria-label="anchor" href="#timeline-and-milestones"></a>
</h2>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<table class="table">
<colgroup>
<col width="15%">
<col width="21%">
<col width="15%">
<col width="10%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th>Phase</th>
<th>Duration</th>
<th>Start</th>
<th>End</th>
<th>Key Deliverable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Phase 0</td>
<td>6 weeks</td>
<td>Jan 2025</td>
<td>Feb 2025</td>
<td>Snowflake test environment</td>
</tr>
<tr class="even">
<td>Phase 1</td>
<td>8 weeks</td>
<td>Mar 2025</td>
<td>Apr 2025</td>
<td>ideadata v5.0.0 (dual backend)</td>
</tr>
<tr class="odd">
<td>Phase 2</td>
<td>4 weeks</td>
<td>May 2025</td>
<td>May 2025</td>
<td>User tools and documentation</td>
</tr>
<tr class="even">
<td>Phase 3</td>
<td>18 months</td>
<td>Jun 2025</td>
<td>Nov 2026</td>
<td>All tables migrated</td>
</tr>
<tr class="odd">
<td>Phase 4</td>
<td>3 months</td>
<td>Dec 2026</td>
<td>Feb 2027</td>
<td>ideadata v6.0.0 (Snowflake only)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="detailed-milestones">Detailed Milestones<a class="anchor" aria-label="anchor" href="#detailed-milestones"></a>
</h3>
<div class="section level4">
<h4 id="q1-2025">Q1 2025<a class="anchor" aria-label="anchor" href="#q1-2025"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox" checked>Snowflake account
provisioned</label></li>
<li><label><input type="checkbox">ODBC drivers installed on all
platforms</label></li>
<li><label><input type="checkbox">Test Snowflake database
created</label></li>
<li><label><input type="checkbox">Development environment
ready</label></li>
</ul>
</div>
<div class="section level4">
<h4 id="q2-2025">Q2 2025<a class="anchor" aria-label="anchor" href="#q2-2025"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox">Phase 1 development
complete</label></li>
<li><label><input type="checkbox">ideadata v5.0.0
released</label></li>
<li><label><input type="checkbox">User training completed</label></li>
<li><label><input type="checkbox">First 10% of tables
migrated</label></li>
</ul>
</div>
<div class="section level4">
<h4 id="q3-2025">Q3 2025<a class="anchor" aria-label="anchor" href="#q3-2025"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox">Phase 2 enhancements
released</label></li>
<li><label><input type="checkbox">30% of tables migrated</label></li>
<li><label><input type="checkbox">User adoption at 80%+</label></li>
</ul>
</div>
<div class="section level4">
<h4 id="q4-2025">Q4 2025<a class="anchor" aria-label="anchor" href="#q4-2025"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox">60% of tables migrated</label></li>
<li><label><input type="checkbox">Performance benchmarking
complete</label></li>
<li><label><input type="checkbox">Optimization round 1
complete</label></li>
</ul>
</div>
<div class="section level4">
<h4 id="q1-q2-2026">Q1-Q2 2026<a class="anchor" aria-label="anchor" href="#q1-q2-2026"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox">90% of tables migrated</label></li>
<li><label><input type="checkbox">SQL Server deprecation
announced</label></li>
<li><label><input type="checkbox">Final migration wave</label></li>
</ul>
</div>
<div class="section level4">
<h4 id="q3-q4-2026">Q3-Q4 2026<a class="anchor" aria-label="anchor" href="#q3-q4-2026"></a>
</h4>
<ul class="task-list">
<li><label><input type="checkbox">100% migration complete</label></li>
<li><label><input type="checkbox">SQL Server
decommissioned</label></li>
<li><label><input type="checkbox">ideadata v6.0.0
released</label></li>
<li><label><input type="checkbox">Migration project
complete</label></li>
</ul>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="risk-assessment">Risk Assessment<a class="anchor" aria-label="anchor" href="#risk-assessment"></a>
</h2>
<table class="table">
<colgroup>
<col width="15%">
<col width="33%">
<col width="20%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Risk</th>
<th>Probability</th>
<th>Impact</th>
<th>Mitigation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Snowflake outage during migration</td>
<td>Medium</td>
<td>High</td>
<td>Maintain SQL Server during transition</td>
</tr>
<tr class="even">
<td>Authentication issues (SSO, MFA)</td>
<td>Medium</td>
<td>Medium</td>
<td>Clear credential setup process</td>
</tr>
<tr class="odd">
<td>SQL dialect incompatibilities</td>
<td>Low</td>
<td>Medium</td>
<td>Extensive testing; dbplyr handles most</td>
</tr>
<tr class="even">
<td>User resistance to change</td>
<td>Low</td>
<td>Low</td>
<td>Transparent migration; no code changes</td>
</tr>
<tr class="odd">
<td>Performance degradation</td>
<td>Low</td>
<td>Medium</td>
<td>Performance testing before migration</td>
</tr>
<tr class="even">
<td>Cost overruns (Snowflake compute)</td>
<td>Medium</td>
<td>Low</td>
<td>Monitor usage; optimize queries</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="success-criteria">Success Criteria<a class="anchor" aria-label="anchor" href="#success-criteria"></a>
</h2>
<div class="section level3">
<h3 id="technical-success">Technical Success<a class="anchor" aria-label="anchor" href="#technical-success"></a>
</h3>
<ul class="task-list">
<li><label><input type="checkbox">100% of tables accessible via
ideadata</label></li>
<li><label><input type="checkbox">No breaking changes to user
code</label></li>
<li><label><input type="checkbox">&lt;2% performance degradation on
typical queries</label></li>
<li><label><input type="checkbox">99.9% uptime during migration
period</label></li>
</ul>
</div>
<div class="section level3">
<h3 id="user-success">User Success<a class="anchor" aria-label="anchor" href="#user-success"></a>
</h3>
<ul class="task-list">
<li><label><input type="checkbox">90%+ user adoption of v5.0.0 within
3 months</label></li>
<li><label><input type="checkbox">&lt;5 support tickets per month
related to migration</label></li>
<li><label><input type="checkbox">Positive user feedback on
transparency of migration</label></li>
</ul>
</div>
<div class="section level3">
<h3 id="business-success">Business Success<a class="anchor" aria-label="anchor" href="#business-success"></a>
</h3>
<ul class="task-list">
<li><label><input type="checkbox">Migration completed within
timeline</label></li>
<li><label><input type="checkbox">No disruption to analytics
workflows</label></li>
<li><label><input type="checkbox">Foundation for future Snowflake
features (e.g., data sharing)</label></li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="future-enhancements-post-migration">Future Enhancements (Post-Migration)<a class="anchor" aria-label="anchor" href="#future-enhancements-post-migration"></a>
</h2>
<p>Once fully on Snowflake, consider:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Direct Snowflake features</strong>
<ul>
<li>Time travel queries</li>
<li>Zero-copy cloning for test data</li>
<li>Secure data sharing with partners</li>
</ul>
</li>
<li>
<strong>Performance optimizations</strong>
<ul>
<li>Materialized views</li>
<li>Clustering keys for large tables</li>
<li>Result caching</li>
</ul>
</li>
<li>
<strong>Advanced analytics</strong>
<ul>
<li>Snowflake-native ML functions</li>
<li>Semi-structured data support (JSON, ARRAY)</li>
<li>External data integration</li>
</ul>
</li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<div class="section level3">
<h3 id="snowflake-documentation">Snowflake Documentation<a class="anchor" aria-label="anchor" href="#snowflake-documentation"></a>
</h3>
<ul>
<li><a href="https://docs.snowflake.com/en/user-guide/odbc" class="external-link">Snowflake
Connector for ODBC</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference" class="external-link">SQL
Translation Reference</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/security" class="external-link">Security
Best Practices</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="rdbi-documentation">R/DBI Documentation<a class="anchor" aria-label="anchor" href="#rdbi-documentation"></a>
</h3>
<ul>
<li><a href="https://solutions.posit.co/connections/db/databases/snowflake/" class="external-link">DBI
with Snowflake</a></li>
<li><a href="https://dbplyr.tidyverse.org/articles/sql-translation.html" class="external-link">dbplyr
SQL translation</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="internal-resources">Internal Resources<a class="anchor" aria-label="anchor" href="#internal-resources"></a>
</h3>
<ul>
<li>Warehouse migration project plan (from Data Warehouse team)</li>
<li>Snowflake account details (from IT)</li>
<li>ideadata GitHub repository</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="appendix-a-example-code-patterns">Appendix A: Example Code Patterns<a class="anchor" aria-label="anchor" href="#appendix-a-example-code-patterns"></a>
</h2>
<div class="section level3">
<h3 id="current-sql-server-only">Current (SQL Server only)<a class="anchor" aria-label="anchor" href="#current-sql-server-only"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://idea-analytics.github.io/ideadata">ideadata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setup (one time)</span></span>
<span><span class="fu"><a href="../reference/setup_creds.html">setup_creds</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Usage</span></span>
<span><span class="va">students</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_students.html">get_students</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">grade_level</span> <span class="op">&gt;=</span> <span class="fl">9</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="future-dual-backend">Future (Dual Backend)<a class="anchor" aria-label="anchor" href="#future-dual-backend"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://idea-analytics.github.io/ideadata">ideadata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setup (one time)</span></span>
<span><span class="fu"><a href="../reference/setup_creds.html">setup_creds</a></span><span class="op">(</span><span class="op">)</span>              <span class="co"># For SQL Server</span></span>
<span><span class="fu">setup_snowflake_creds</span><span class="op">(</span><span class="op">)</span>    <span class="co"># For Snowflake</span></span>
<span></span>
<span><span class="co"># Usage - IDENTICAL!</span></span>
<span><span class="va">students</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_students.html">get_students</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">grade_level</span> <span class="op">&gt;=</span> <span class="fl">9</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check backend (optional)</span></span>
<span><span class="fu">which_backend</span><span class="op">(</span><span class="st">"Students"</span><span class="op">)</span></span>
<span><span class="co"># [1] "snowflake"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="future-snowflake-only-v6-0-0">Future (Snowflake only, v6.0.0)<a class="anchor" aria-label="anchor" href="#future-snowflake-only-v6-0-0"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://idea-analytics.github.io/ideadata">ideadata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setup (one time)</span></span>
<span><span class="fu"><a href="../reference/setup_creds.html">setup_creds</a></span><span class="op">(</span><span class="op">)</span>              <span class="co"># Now sets up Snowflake creds</span></span>
<span></span>
<span><span class="co"># Usage - STILL IDENTICAL!</span></span>
<span><span class="va">students</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_students.html">get_students</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">grade_level</span> <span class="op">&gt;=</span> <span class="fl">9</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="appendix-b-sql-dialect-differences">Appendix B: SQL Dialect Differences<a class="anchor" aria-label="anchor" href="#appendix-b-sql-dialect-differences"></a>
</h2>
<div class="section level3">
<h3 id="t-sql-sql-server-vs-ansi-sql-snowflake">T-SQL (SQL Server) vs ANSI SQL (Snowflake)<a class="anchor" aria-label="anchor" href="#t-sql-sql-server-vs-ansi-sql-snowflake"></a>
</h3>
<table class="table">
<colgroup>
<col width="13%">
<col width="28%">
<col width="31%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Feature</th>
<th>SQL Server (T-SQL)</th>
<th>Snowflake (ANSI SQL)</th>
<th>dbplyr Handles?</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>String concatenation</td>
<td><code>+</code></td>
<td><code>||</code></td>
<td>Yes</td>
</tr>
<tr class="even">
<td>LIMIT</td>
<td><code>TOP N</code></td>
<td><code>LIMIT N</code></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Date functions</td>
<td>
<code>DATEADD</code>, <code>DATEDIFF</code>
</td>
<td>
<code>DATEADD</code>, <code>DATEDIFF</code>
</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>ISNULL</td>
<td><code>ISNULL(col, val)</code></td>
<td><code>IFNULL(col, val)</code></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Case sensitivity</td>
<td>Case-insensitive</td>
<td>Case-sensitive</td>
<td><strong>User must handle</strong></td>
</tr>
<tr class="even">
<td>Boolean</td>
<td>No true boolean</td>
<td>TRUE/FALSE</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="handling-case-sensitivity">Handling Case Sensitivity<a class="anchor" aria-label="anchor" href="#handling-case-sensitivity"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SQL Server (works regardless of case)</span></span>
<span><span class="fu"><a href="../reference/get_table.html">get_table</a></span><span class="op">(</span><span class="st">"students"</span><span class="op">)</span>     <span class="co"># OK</span></span>
<span><span class="fu"><a href="../reference/get_table.html">get_table</a></span><span class="op">(</span><span class="st">"Students"</span><span class="op">)</span>     <span class="co"># OK</span></span>
<span><span class="fu"><a href="../reference/get_table.html">get_table</a></span><span class="op">(</span><span class="st">"STUDENTS"</span><span class="op">)</span>     <span class="co"># OK</span></span>
<span></span>
<span><span class="co"># Snowflake (case-sensitive)</span></span>
<span><span class="fu"><a href="../reference/get_table.html">get_table</a></span><span class="op">(</span><span class="st">"STUDENTS"</span><span class="op">)</span>     <span class="co"># Must match exact case in database</span></span></code></pre></div>
<p><strong>Solution</strong>: Metadata stores exact case;
<code><a href="../reference/get_table.html">get_table()</a></code> uses exact match.</p>
<hr>
<p><strong>Document Version</strong>: 1.0 <strong>Last Updated</strong>:
2024 <strong>Owner</strong>: IDEA Analytics Team
<strong>Status</strong>: Draft for Review</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Chris Haid.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
